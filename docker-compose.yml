version: '3.9'

networks:
  media-net:
    name: media-net

services:
  # --- ğŸ›¡ï¸ Infrastructure (ê´€ì œ ë° ì¸í”„ë¼) ---
  homepage:
    image: ghcr.io/gethomepage/homepage:latest
    container_name: homepage
    ports:
      - "3000:3000"
    volumes:
      - /home/crong/heritage/homepage/config:/app/config
      - /run/user/1000/podman/podman.sock:/var/run/docker.sock:ro # Podman User Socket
      - /mnt:/mnt:ro # Storage ìœ„ì ¯ìš©
    networks:
      - media-net
    restart: unless-stopped
    environment:
      - HOMEPAGE_ALLOWED_HOSTS=*

  prowlarr:
    image: ghcr.io/hotio/prowlarr:latest
    container_name: prowlarr
    ports:
      - "9696:9696"
    environment:
      - PUID=1000
      - PGID=1000
    volumes:
      - /home/crong/heritage/prowlarr:/config
    networks:
      - media-net
    restart: unless-stopped

  # --- ğŸ“¥ Acquisition Engines (ìˆ˜ì§‘ ì—”ì§„) ---
  rtorrent-rutorrent:
    image: docker.io/crazymax/rtorrent-rutorrent:latest
    container_name: rtorrent-rutorrent
    environment:
      - PUID=1000
      - PGID=1000
    ports:
      - "8080:8080"
    volumes:
      - /home/crong/heritage/rtorrent:/data
      - /mnt/data1/torrent:/downloads      # sda1: Inbound Staging (ë°›ëŠ” ê³³)
      - /mnt/data2/torrent:/completed_hdd2 # sdb1: The Vault (ì´ë™ë  ê³³)
    networks:
      - media-net
    restart: always

  jdownloader:
    image: docker.io/jlesage/jdownloader-2
    container_name: jdownloader
    ports:
      - "5800:5800"
    environment:
      - PUID=1000
      - PGID=1000
      - JAVA_OPTIONS=-Xmx512m -Xms256m -XX:+UseSerialGC # N100 8G ìµœì í™”
    volumes:
      - /home/crong/heritage/jdownloader-2:/config
      - /mnt/data1/torrent/jd2_downloads:/output # sda1 í™œìš©
    mem_limit: 1g
    networks:
      - media-net
    restart: unless-stopped

  # --- ğŸ›ï¸ Curatorial Tools (ê¸°ë¡ ë° ë¶„ë¥˜) ---
  whisparr:
    image: ghcr.io/hotio/whisparr:latest
    container_name: whisparr
    ports:
      - "6969:6969"
    environment:
      - PUID=1000
      - PGID=1000
    volumes:
      - /home/crong/heritage/whisparr:/config
      - /mnt/data1/torrent:/data1
      - /mnt/data2/torrent:/data2
    networks:
      - media-net
    restart: unless-stopped

  stash:
    image: docker.io/stashapp/stash:latest
    container_name: stash
    ports:
      - "9999:9999"
    environment:
      - STASH_CONFIG_FILE=/config/config.yml
    volumes:
      - /home/crong/heritage/stash:/config
      - /mnt/data1/torrent:/data1
      - /mnt/data2/torrent:/data2
    networks:
      - media-net
    restart: unless-stopped

  # --- ğŸ­ Digital Theater (ì „ì‹œ ë° ìŠ¤íŠ¸ë¦¬ë°) ---
  jellyfin:
    image: docker.io/jellyfin/jellyfin:latest
    container_name: jellyfin
    ports:
      - "8096:8096"
    devices:
      - /dev/dri/renderD128:/dev/dri/renderD128 # Intel QSV ê°€ì†
    volumes:
      - /home/crong/heritage/jellyfin:/config
      - /mnt/data1/torrent:/data1
      - /mnt/data2/torrent:/data2
    networks:
      - media-net
    restart: unless-stopped
